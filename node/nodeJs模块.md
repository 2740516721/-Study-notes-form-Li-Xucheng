# CommonJs和NodeJs模块、自定义模块

#### 什么是CommonJs?

**CommonJs**是一种 JavaScript 语言的模块化规范，它通常会在服务端的 Nodejs 上使用。项目是由多个模块组成的，模块和模块之间的调用，需要各个模块有相同规范的 API，这样一来在使用的过程中不会有那么多的学习成本，并且对于单个模块来说是类聚的。 

在 **CommonJs** 的模块化规范中，每一个文件就是一个模块，拥有自己独立的作用域、变量、以及方法等，对其他的模块都不可见。CommonJS规范规定，每个模块内部，module 变量代表当前模块。这个变量是一个对象，它的 exports 属性（module.exports）是对外的接口。加载某个模块，其实是加载该模块的 module.exports 属性。require 方法用于加载模块。



#### 说明

在node中，模块分为两类，一类是node提供的模块，（例如http模块）称为核心模块；一类是用户编写的模块，称为文件模块。



#### CommonJs(nodeJs)中自定义模块的规定

1、我们可以把公共的功能 抽离成为一个单独的js文件 作为一个模块，默认情况下面这个模块里面的方法或者属性，外面是没法访问的。如果要让外部可以访问模块里面的方法或者属性，就必须在模块里面通过 exports 或module.exports 暴露属性或者方法。

2、在需要使用这些模块的文件中，通过 require 的方式引入这个模块。这个时候就可以使用模块里面暴露的属性和方法。

如图：

![1](D:\前端开发\前端开发学习笔记\-Study-notes-form-Li-Xucheng\node\1.png)



#### 自定义模块

自定义模块就是把公共的功能（一个方法、属性、对象、函数等）抽离成一个单独的JS文件，在需要的文件中引入它。

##### 实现过程

1、建一个公共的JS文件。

2、暴露属性或方法（因为默认模块中的方法或者属性，外部是无法访问的，因此需要暴露）。

​	2.1、exports.自定义name = 该方法或者属性;（如果当中有很多方法，建议用此方法暴露）

​	2.2、module.exports = 要暴露的方法或者属性;（如果把所有东西都封装到对象中，建议用此方法暴露）

3、用	require('路径')	进行引用。



#### 更加简便的引入方式

把模块放入新建的 node_modules 文件夹中。利用模块的名称建立一个文件夹，文件夹中的JS文件名称为  index.js  （如不是这样命名，则引入不成功。解决的方法是，在该模块名称命名的文件夹内初始化 	npm  。即在该文件夹下的命令行中输入该代码：npm init）。然后将该文件夹放入  node_modules  文件夹中。



![2](D:\前端开发\前端开发学习笔记\-Study-notes-form-Li-Xucheng\node\2.png)





![3](D:\前端开发\前端开发学习笔记\-Study-notes-form-Li-Xucheng\node\3.png)